<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Bluejay  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="Bluejay  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">Bluejay Docs</a> (44% documented)</p>
        <p class="header-right"><a href="https://github.com/steamclock/bluejay"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">Bluejay Reference</a>
        <img id="carat" src="img/carat.png" />
        Bluejay  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/Bluejay.html">Bluejay</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Peripheral.html">Peripheral</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SynchronizedPeripheral.html">SynchronizedPeripheral</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enums</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/BackgroundRestoreMode.html">BackgroundRestoreMode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ConnectionResult.html">ConnectionResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/DisconnectionResult.html">DisconnectionResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/DiscoveryResult.html">DiscoveryResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ListenAction.html">ListenAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ReadResult.html">ReadResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/RunResult.html">RunResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ScanAction.html">ScanAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/WriteResult.html">WriteResult</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/CBManagerState.html">CBManagerState</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/CBPeripheral.html">CBPeripheral</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/CBPeripheralState.html">CBPeripheralState</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/CBService.html">CBService</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Data.html">Data</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Integer.html">Integer</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Notification.html">Notification</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/String.html">String</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/ConnectionObserver.html">ConnectionObserver</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ListenRestorer.html">ListenRestorer</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/RSSIObserver.html">RSSIObserver</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Receivable.html">Receivable</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Sendable.html">Sendable</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structs</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/CharacteristicIdentifier.html">CharacteristicIdentifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/DataPadding.html">DataPadding</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/PeripheralIdentifier.html">PeripheralIdentifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ScanDiscovery.html">ScanDiscovery</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ServiceIdentifier.html">ServiceIdentifier</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='bluejay' class='heading'>Bluejay</h1>

<p>Bluejay is a simple Swift framework for building reliable Bluetooth apps.</p>

<p>Bluejay&rsquo;s primary goals are:</p>

<ul>
<li>Simplify talking to a Bluetooth device</li>
<li>Make good use of Swift features and conventions</li>
<li>Make it easier to build Bluetooth apps that are actually reliable</li>
</ul>
<h2 id='requirements' class='heading'>Requirements</h2>

<ul>
<li>iOS 10 or above</li>
<li>Xcode 8.2.1 or above</li>
</ul>
<h2 id='getting-started' class='heading'>Getting started</h2>

<p>Install using CocoaPods:</p>

<p><code>pod &#39;Bluejay&#39;, :git =&gt; &#39;https://github.com/steamclock/bluejay.git&#39;, :branch =&gt; &#39;master&#39;</code></p>

<p>Import using:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">Bluejay</span>
</code></pre>
<h2 id='demo-app' class='heading'>Demo App</h2>

<p>The Simulator does not simulate Bluetooth, so it is easiest to demo Bluetooth with a virtual BLE peripheral. To set this up:</p>

<ol>
<li>Prepare two iOS devices, one will act as a virtual BLE peripheral, and the other will run the demo app using the Bluejay API.</li>
<li>On the iOS device serving as a virtual BLE peripheral, go to the App Store and download the free <a href="https://itunes.apple.com/ca/app/lightblue-explorer-bluetooth/id557428110?mt=8">LightBlue Explorer</a> app.</li>
<li>Open the LightBlue Explorer app, and tap on the <q>Create Virtual Peripheral</q> button located at the bottom of the peripheral list.</li>
<li>For simplicity, choose <q>Heart Rate</q> from the base profile list, and finish by tapping the <q>Save</q> button located at the top right of the screen.</li>
<li>Finally, build and run the BluejayDemo app on the other iOS device, and you will be able to interact with the virtual heart rate peripheral using Bluejay.</li>
</ol>

<p>Notes:</p>

<ul>
<li>You can turn the virtual peripheral on or off in LightBlue Explorer by tapping and toggling the blue checkmark to the left of the virtual peripheral&rsquo;s name in the peripheral list.

<ul>
<li>If the virtual peripheral is not working as expected, you can try to reset it this way.</li>
</ul></li>
<li>By default, the demo app will read and write to the <q>Body Sensor Location</q> characteristic, and listen to the <q>Heart Rate Measurement</q> characteristic.

<ul>
<li>The heart rate measurement returns only zeroes by default, because it is a virtual peripheral without an actual heart rate detector.</li>
</ul></li>
<li>You can use LightBlue Explorer to update various characteristics in the virtual peripheral.</li>
</ul>
<h2 id='usage' class='heading'>Usage</h2>

<p>The Bluejay interface can be accessed through using the <code>Bluejay</code> singleton:</p>
<pre class="highlight swift"><code><span class="n">fileprivate</span> <span class="k">let</span> <span class="nv">bluejay</span> <span class="o">=</span> <span class="kt">Bluejay</span><span class="o">.</span><span class="n">shared</span>
</code></pre>
<h3 id='initialization' class='heading'>Initialization</h3>

<p>Start Bluejay during initialization of your app or view controller, as appropriate. For example, in the demo app Bluejay is started inside <code>viewDidLoad</code> of the root view controller.</p>
<pre class="highlight swift"><code><span class="n">bluejay</span><span class="o">.</span><span class="nf">start</span><span class="p">(</span><span class="nv">connectionObserver</span><span class="p">:</span> <span class="k">self</span><span class="p">,</span> <span class="nv">listenRestorer</span><span class="p">:</span> <span class="k">self</span><span class="p">,</span> <span class="nv">enableBackgroundMode</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
</code></pre>

<p>Bluejay is started explicitly because this gives your app an opportunity to make sure the critical delegates are instantiated and available before the CoreBluetooth stack is initialized. This ensures that CoreBluetooth&rsquo;s startup and restoration events are handled.</p>

<p>Note:</p>

<p>Background mode is disabled by default. In order to support background mode, you must set the parameter <code>enableBackgroundMode</code> to true when you call <code>start</code>, as well as turn on the <q>Background Modes</q> capability in your Xcode project with <q>Uses Bluetooth LE accessories</q> enabled.</p>
<h3 id='bluetooth-events' class='heading'>Bluetooth Events</h3>

<p>The <code>observer</code> conforms to the <code>ConnectionObserver</code> protocol, and allows the delegate to react to major connection-related events:</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">protocol</span> <span class="kt">ConnectionObserver</span><span class="p">:</span> <span class="kd">class</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">bluetoothAvailable</span><span class="p">(</span><span class="n">_</span> <span class="nv">available</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span>
    <span class="kd">func</span> <span class="nf">connected</span><span class="p">(</span><span class="n">_</span> <span class="nv">peripheral</span><span class="p">:</span> <span class="kt">Peripheral</span><span class="p">)</span>
    <span class="kd">func</span> <span class="nf">disconected</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>

<p>You can add additional observers using:</p>
<pre class="highlight swift"><code><span class="n">bluejay</span><span class="o">.</span><span class="nf">register</span><span class="p">(</span><span class="nv">observer</span><span class="p">:</span> <span class="n">batteryLabel</span><span class="p">)</span>
</code></pre>

<p>Unregistering an observer is not typically necessary, because Bluejay only holds weak references to registered observers. But if you require unregistering an observer explicitly, use:</p>
<pre class="highlight swift"><code><span class="n">bluejay</span><span class="o">.</span><span class="nf">unregister</span><span class="p">(</span><span class="nv">observer</span><span class="p">:</span> <span class="n">batteryLabel</span><span class="p">)</span>
</code></pre>
<h3 id='services-amp-characteristics' class='heading'>Services &amp; Characteristics</h3>

<p>In Bluetooth parlance, a Service is a group of attributes, and a Characteristic is an attribute belonging to a category. For example, BLE peripherals that can detect heart rates usually have a Service named <q>Heart Rate</q> with a UUID of <q>180D</q>. Inside that Service are Characteristics such as <q>Body Sensor Location</q> with a UUID of <q>2A38</q>, as well as <q>Heart Rate Measurement</q> with a UUID of <q>2A37</q>.</p>

<p>Many of these Services and Characteristics are standards specified by the Bluetooth SIG organization, and most hardware adopt their specifications. For example, most BLE peripherals have the Service <q>Device Information</q> with a UUID of <q>180A</q>, where Characteristics such as firmware version, serial number, and other hardware details can be read and written. Of course, there are many BLE uses not covered by the Bluetooth Core Spec, and custom hardware often have their own unique Services and Characteristics.</p>

<p>Here is how you can specify Services and Characteristics for use in Bluejay:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">heartRateService</span> <span class="o">=</span> <span class="kt">ServiceIdentifier</span><span class="p">(</span><span class="nv">uuid</span><span class="p">:</span> <span class="s">"180D"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">bodySensorLocation</span> <span class="o">=</span> <span class="kt">CharacteristicIdentifier</span><span class="p">(</span><span class="nv">uuid</span><span class="p">:</span> <span class="s">"2A38"</span><span class="p">,</span> <span class="nv">service</span><span class="p">:</span> <span class="n">heartRateService</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">heartRate</span> <span class="o">=</span> <span class="kt">CharacteristicIdentifier</span><span class="p">(</span><span class="nv">uuid</span><span class="p">:</span> <span class="s">"2A37"</span><span class="p">,</span> <span class="nv">service</span><span class="p">:</span> <span class="n">heartRateService</span><span class="p">)</span>
</code></pre>
<h3 id='scanning-amp-connecting' class='heading'>Scanning &amp; Connecting</h3>
<pre class="highlight swift"><code><span class="n">bluejay</span><span class="o">.</span><span class="nf">scan</span><span class="p">(</span><span class="nv">service</span><span class="p">:</span> <span class="n">heartRateService</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">peripheral</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Scan succeeded with peripheral: </span><span class="se">\(</span><span class="n">peripheral</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>

        <span class="k">self</span><span class="o">.</span><span class="n">bluejay</span><span class="o">.</span><span class="nf">connect</span><span class="p">(</span><span class="kt">PeripheralIdentifier</span><span class="p">(</span><span class="nv">uuid</span><span class="p">:</span> <span class="n">peripheral</span><span class="o">.</span><span class="n">identifier</span><span class="p">),</span> <span class="nv">completion</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
            <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
            <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">peripheral</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Connect succeeded with peripheral: </span><span class="se">\(</span><span class="n">peripheral</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Connect failed with error: </span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">})</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Scan failed with error: </span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<pre class="highlight swift"><code><span class="n">bluejay</span><span class="o">.</span><span class="nf">disconnect</span><span class="p">()</span>
</code></pre>
<h3 id='reading-and-writing' class='heading'>Reading and Writing</h3>
<pre class="highlight swift"><code><span class="n">bluejay</span><span class="o">.</span><span class="nf">read</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">bodySensorLocation</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="nv">result</span><span class="p">:</span> <span class="kt">ReadResult</span><span class="o">&lt;</span><span class="kt">IncomingString</span><span class="o">&gt;</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">value</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Read succeeded with value: </span><span class="se">\(</span><span class="n">value</span><span class="o">.</span><span class="n">string</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Read failed with error: </span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<pre class="highlight swift"><code><span class="n">bluejay</span><span class="o">.</span><span class="nf">write</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">bodySensorLocation</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">OutgoingString</span><span class="p">(</span><span class="s">"Wrist"</span><span class="p">))</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">success</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Write succeeded."</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Write failed with error: </span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='listening' class='heading'>Listening</h3>
<pre class="highlight swift"><code><span class="n">bluejay</span><span class="o">.</span><span class="nf">listen</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">heartRate</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="nv">result</span><span class="p">:</span> <span class="kt">ReadResult</span><span class="o">&lt;</span><span class="kt">UInt8</span><span class="o">&gt;</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">value</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Listen succeeded with value: </span><span class="se">\(</span><span class="n">value</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Listen failed with error: </span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<pre class="highlight swift"><code><span class="n">bluejay</span><span class="o">.</span><span class="nf">endListen</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">heartRate</span><span class="p">)</span>
</code></pre>
<h3 id='receivable-amp-sendable' class='heading'>Receivable &amp; Sendable</h3>

<p>The <code>Receivable</code> and <code>Sendable</code> protocols provide the blueprints to model the data packets being exchanged between the your app and the BLE peripheral, and are mandatory to type the results and the deliverables when using the <code>read</code> and <code>write</code> functions.</p>

<p>Examples:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">IncomingString</span><span class="p">:</span> <span class="kt">Receivable</span> <span class="p">{</span>

    <span class="k">var</span> <span class="nv">string</span><span class="p">:</span> <span class="kt">String</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">bluetoothData</span><span class="p">:</span> <span class="kt">Data</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">string</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="nv">data</span><span class="p">:</span> <span class="n">bluetoothData</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span><span class="o">!</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">OutgoingString</span><span class="p">:</span> <span class="kt">Sendable</span> <span class="p">{</span>

    <span class="k">var</span> <span class="nv">string</span><span class="p">:</span> <span class="kt">String</span>

    <span class="nf">init</span><span class="p">(</span><span class="n">_</span> <span class="nv">string</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="n">string</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">toBluetoothData</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Data</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="nf">data</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span><span class="o">!</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre>
<h3 id='listen-restoration' class='heading'>Listen Restoration</h3>

<p>Listen Restoration is how iOS supports background modes in Bluetooth LE.</p>

<p>From Apple&rsquo;s docs:</p>

<blockquote>
<p>[CoreBluetooth can] preserve the state of your app’s central and peripheral managers and to continue performing certain Bluetooth-related tasks on their behalf, even when your app is no longer running. When one of these tasks completes, the system relaunches your app into the background and gives your app the opportunity to restore its state and to handle the event appropriately.</p>
</blockquote>

<p>Therefore, when your app has stopped running either due to memory pressure or by staying in the background past the allowed duration (3 minutes since iOS 7), then the next time your app is launched, the <code>ListenRestorer</code> protocol provides an opportunity to restore the lost callbacks to the still ongoing listens.</p>
<pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">protocol</span> <span class="kt">ListenRestorer</span><span class="p">:</span> <span class="kd">class</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">willRestoreListen</span><span class="p">(</span><span class="n">on</span> <span class="nv">characteristic</span><span class="p">:</span> <span class="kt">CharacteristicIdentifier</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
<span class="p">}</span>
</code></pre>

<p>By default, if there is no <code>ListenRestorer</code> delegate provided in the <code>start</code> function, then <strong>all</strong> active listens will effectively end when your app stops running.</p>

<p>The listen restorer can only be provided to Bluejay via its <code>start</code> function, because the restorer must be available to respond before CoreBluetooth initiates state restoration.</p>

<p>To restore the callback on the given characteristic, call the <code>restoreListen</code> function and return true, otherwise, return false and Bluejay will end listening on that characteristic for you:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">ListenRestorer</span> <span class="p">{</span>

    <span class="kd">func</span> <span class="nf">willRestoreListen</span><span class="p">(</span><span class="n">on</span> <span class="nv">characteristic</span><span class="p">:</span> <span class="kt">CharacteristicIdentifier</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">characteristic</span> <span class="o">==</span> <span class="n">heartRate</span> <span class="p">{</span>
            <span class="n">bluejay</span><span class="o">.</span><span class="nf">restoreListen</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">heartRate</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="nv">result</span><span class="p">:</span> <span class="kt">ReadResult</span><span class="o">&lt;</span><span class="kt">UInt8</span><span class="o">&gt;</span><span class="p">)</span> <span class="k">in</span>
                <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">value</span><span class="p">):</span>
                    <span class="n">log</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Listen succeeded with value: </span><span class="se">\(</span><span class="n">value</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
                    <span class="n">log</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Listen failed with error: </span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">})</span>

            <span class="k">return</span> <span class="kc">true</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="kc">false</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre>
<h2 id='documentaion' class='heading'>Documentaion</h2>

<p><a href="https://steamclock.github.io/bluejay/overview.html">https://steamclock.github.io/bluejay/overview.html</a></p>

          </section>
        </section>
        <section id="footer">
          <p>Copyright © 2017 Steamclock Software. All rights reserved.</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.8.2</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
